<!DOCTYPE html>
<html>
<head>
  <title>Video iframe</title>
  <script src="https://www.youtube.com/player_api"></script>
</head>

<body>
  <div id="ytplayer"></div>

  <script>
    var player;

    function onYouTubePlayerAPIReady() {
      var playerVars = {}

      var hash = parseHashString(document.location.hash)
      var videoId = hash.v
      var time = toSeconds(parseTime(hash.t))

      if (time > 0) playerVars.start = time

      player = new YT.Player('ytplayer', {
        height: '100%',
        width: '100%',
        videoId: videoId,
        playerVars: playerVars,
        events: {
          onReady: onPlayerReady,
          onStateChange: onStateChange
        }
      });
    }

    function onPlayerReady(event) {
      player.mute();
      player.playVideo();
    }

    function onStateChange(event) {
      if (event.data === YT.PlayerState.ENDED) {
        player.playVideo();
      }
    }

    function parseTime (time) {
      time = time || ''

      var reg = /([0-9]*h)?([0-9]*m)?([0-9]*s?)/
      var matches = time.match(reg)

      var hours = parseInt(matches[1], 10) || 0
      var minutes = parseInt(matches[2], 10) || 0
      var seconds = parseInt(matches[3], 10) || 0

      return {
        hours: hours,
        minutes: minutes,
        seconds: seconds
      }
    }

    function toSeconds (timeObj) {
      return timeObj.hours * 3600 + timeObj.minutes * 60 + timeObj.seconds
    }

    function parseHashString (hash) {
      if (hash.indexOf('#') === 0) hash = hash.slice(1)

      var hashData = hash.split('&')

      return hashData.reduce((obj, data) => {
        var keyValue = data.split('=')
        var key = decodeURIComponent(keyValue[0])
        var value = decodeURIComponent(keyValue[1])

        obj[key] = value
        return obj
      }, {})
    }
  </script>

  <style>
    html, body {
      border: 0;
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
    }
  </style>

</body>
</html>
